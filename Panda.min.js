/**
 * Panda.js
 * Client side syntax highlighter for HTML, CSS and Javascript
 *
 * Copyright 2011-2012 AvacWeb (avacweb.com)
 * Released under the MIT and GPL Licenses.
 */
(function(){function m(b,a){return a?b.replace(/\n/g,"<br/>"):b.replace(/\<br\s?\/?\>/g,"\n")}function n(b,a,d){return b.replace(RegExp("(^|\\W)"+a+"(\\W)","g"),function(b){return b.replace(a,'<span class="'+d+'">'+a+"</span>")})}var b={lineNumbering:!0,regex:{regex:/\/(.(?!\\\/)).*\//g,comment1:/(?!:(?=\/))[^:]\/\/[^\n]*/g,comment2:/\/\*(.|[\n\r])*?\*\//gm,comment3:/#[^\n]*/g,comment4:/(&lt;|<)!--.*?--(&gt;|>)/g,string1:/"(\\"|[^"])*"/g,string2:/'(\\'|[^'])*'/g,multiLineString1:/"(\\"|[^"])*"/gm,multiLineString2:/'(\\'|[^'])*'/gm,phptag:/((?:<|&lt;)\?(php)?)|(?:\?(?:>|&gt;))/g,htmltag:/(?:&lt;|\<).+?(?:&gt;|\>)/g,htmlspecial:/(?:&lt;|\<)\/?(head|html|body|a|script|meta|link)#?.*?(?:&gt;|\>)/g,operators:/(?:(!|=)?==?)|(?:\|\|)|[\-\+\>\/\*%]/g,attribute:/\s[\w\-]+(?==["'].*?['"])/g,phpvar:/\$[\w\d_]+(?=\W)/g,selector:/.*?(?=\s*\{)/g,extra:/[:\{\}\[\]\(\)]/g}};"js html css php".replace(/\w+/g,function(c){b[c]={}});b.js.keywords="var function return if else while do this new typeof for null false true".split(" ");b.js.specials="document window Array RegExp Object Math String Number Date".split(" ");b.js.matchers="comment1 comment2 string1 string2 regex operators extra".split(" ");b.html.keywords=b.html.specials=[];b.html.matchers=["comment4","attribute","htmlspecial","htmltag"];b.php.keywords="var function private public static if else return while do this new typeof for foreach as null false true".split(" ");b.php.specials="echo require include int array global".split(" ");b.php.matchers="comment3 comment2 comment1 multiLineString1 multiLineString2 phpvar phptag operators extra".split(" ");b.css.keywords=b.css.specials=[];b.css.matchers=["comment2","string1","string2","selector","extra"];b.parse=function(c,a){var d=b[c];if(!d)return a;for(var f=d.matchers,i=d.keywords,h=d.specials,o=(new Date).getTime(),d={},a=m(a.replace(/(^[\s\t\n]+)|([\s\t\n]+$)/g,"")),e=0,j=f.length;e<j;e++){var g=f[e],l=this.regex[g],p="#"+g+"_"+o+"_",q=0,r=d[g]={};l&&(a=a.replace(l,function(a){var b=p+q++ +"_"+(l.multiline?"m":"")+"#";r[b]=a;return b}))}e=0;for(j=i.length;e<j;e++)a=n(a,i[e],"panda-keyword");e=0;for(j=h.length;e<j;e++)a=n(a,h[e],"panda-special");for(e=f.length;e;e--){var g=f[e-1],i=d[g],k;for(k in i)h=i[k],k.indexOf("_m_#")&&(h=h.replace(/\n/g,'</span>\n<span class="panda-'+g+'">')),a=a.replace(k,'<span class="panda-'+g+'">'+h+"</span>")}this.lineNumbering&&(a='<ol class="pandaCode"><li>'+a.split(/\n/).join("</li><li>")+"</li></ol>");return m(a.replace(/\t|(    )/g,"&nbsp;&nbsp;&nbsp;&nbsp;"),1)};b.colorNode=function(c){var a=/(?:\s|^)panda_(\w+)(?:\s|$)/;if(a.test(c.className)){a=a.exec(c.className)[1];if("code"==c.nodeName.toLowerCase()&&"pre"!=c.parentNode.nodeName.toLowerCase()){var d=document.createElement("pre");c.parentNode.insertBefore(d,c);d.appendChild(c)}c.innerHTML=b.parse(a,c.innerHTML)}};b.addKeyword=function(c,a){b[c].keywords.push(a)};b.addSpecial=function(c,a){b[c].specials.push(a)};b.addLang=function(c,a){if("matchers"in a&&"keywords"in a&&"specials"in a){var d=b[c]={};d.matchers="string"==typeof a.matchers?a.matchers.split(" "):a.matchers;d.specials="string"==typeof a.specials?a.specials.split(" "):a.specials;d.keywords="string"==typeof a.keywords?a.keywords.split(" "):a.keywords;if(a.regex&&"object"==typeof a.regex)for(var f in a.regex)b.regex[f]=a.regex[f]}};"object"===typeof module&&"object"===typeof module.exports?module.exports=b:window.panda=b})();